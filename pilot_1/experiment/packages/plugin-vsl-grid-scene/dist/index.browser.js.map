{"version":3,"file":"index.browser.js","sources":["../src/index.ts"],"sourcesContent":["import { JsPsych, JsPsychPlugin, ParameterType, TrialType } from \"jspsych\";\n\nconst info = <const>{\n  name: \"vsl-grid-scene\",\n  parameters: {\n    /** An array of images that defines a grid. */\n    stimuli: {\n      type: ParameterType.IMAGE,\n      pretty_name: \"Stimuli\",\n      array: true,\n      default: undefined,\n    },\n    /** Array specifying the width and height of the images to show. */\n    image_size: {\n      type: ParameterType.INT,\n      pretty_name: \"Image size\",\n      array: true,\n      default: [100, 100],\n    },\n    /** How long to show the stimulus for in milliseconds. */\n    trial_duration: {\n      type: ParameterType.INT,\n      pretty_name: \"Trial duration\",\n      default: 2000,\n    },\n  },\n};\n\ntype Info = typeof info;\n\n/**\n * **vsl-grid-scene**\n *\n * jsPsych plugin for showing scenes that mimic the experiments described in\n * Fiser, J., & Aslin, R. N. (2001). Unsupervised statistical learning of\n * higher-order spatial structures from visual scenes. Psychological science,\n * 12(6), 499-504.\n *\n * @author Josh de Leeuw\n * @see {@link https://www.jspsych.org/plugins/jspsych-vsl-grid-scene/ vsl-grid-scene plugin documentation on jspsych.org}\n */\nclass VslGridScenePlugin implements JsPsychPlugin<Info> {\n  static info = info;\n\n  constructor(private jsPsych: JsPsych) {}\n\n  trial(display_element: HTMLElement, trial: TrialType<Info>) {\n    display_element.innerHTML = VslGridScenePlugin.generate_stimulus(\n      trial.stimuli,\n      trial.image_size\n    );\n\n    this.jsPsych.pluginAPI.setTimeout(function () {\n      endTrial();\n    }, trial.trial_duration);\n\n    const endTrial = () => {\n      display_element.innerHTML = \"\";\n\n      var trial_data = {\n        stimulus: trial.stimuli,\n      };\n\n      this.jsPsych.finishTrial(trial_data);\n    };\n  }\n\n  static generate_stimulus(pattern, image_size: number[]) {\n    var nrows = pattern.length;\n    var ncols = pattern[0].length;\n\n    // create blank element to hold code that we generate\n    var html = '<div id=\"jspsych-vsl-grid-scene-dummy\" css=\"display: none;\">';\n\n    // create table\n    html +=\n      '<table id=\"jspsych-vsl-grid-scene table\" ' +\n      'style=\"border-collapse: collapse; margin-left: auto; margin-right: auto;\">';\n\n    for (var row = 0; row < nrows; row++) {\n      html +=\n        '<tr id=\"jspsych-vsl-grid-scene-table-row-' +\n        row +\n        '\" css=\"height: ' +\n        image_size[1] +\n        'px;\">';\n\n      for (var col = 0; col < ncols; col++) {\n        html +=\n          '<td id=\"jspsych-vsl-grid-scene-table-' +\n          row +\n          \"-\" +\n          col +\n          '\" ' +\n          'style=\"padding: ' +\n          image_size[1] / 10 +\n          \"px \" +\n          image_size[0] / 10 +\n          'px; border: 1px solid #555;\">' +\n          '<div id=\"jspsych-vsl-grid-scene-table-cell-' +\n          row +\n          \"-\" +\n          col +\n          '\" style=\"width: ' +\n          image_size[0] +\n          \"px; height: \" +\n          image_size[1] +\n          'px;\">';\n        if (pattern[row][col] !== 0) {\n          html +=\n            \"<img \" +\n            'src=\"' +\n            pattern[row][col] +\n            '\" style=\"width: ' +\n            image_size[0] +\n            \"px; height: \" +\n            image_size[1] +\n            '\"></img>';\n        }\n        html += \"</div>\";\n        html += \"</td>\";\n      }\n      html += \"</tr>\";\n    }\n\n    html += \"</table>\";\n    html += \"</div>\";\n\n    return html;\n  }\n}\n\nexport default VslGridScenePlugin;\n"],"names":["ParameterType"],"mappings":"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"}