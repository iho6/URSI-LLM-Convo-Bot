{"version":3,"file":"index.cjs","sources":["../src/index.ts"],"sourcesContent":["import { JsPsych, JsPsychPlugin, ParameterType, TrialType } from \"jspsych\";\n\nconst info = <const>{\n  name: \"vsl-grid-scene\",\n  parameters: {\n    /** An array of images that defines a grid. */\n    stimuli: {\n      type: ParameterType.IMAGE,\n      pretty_name: \"Stimuli\",\n      array: true,\n      default: undefined,\n    },\n    /** Array specifying the width and height of the images to show. */\n    image_size: {\n      type: ParameterType.INT,\n      pretty_name: \"Image size\",\n      array: true,\n      default: [100, 100],\n    },\n    /** How long to show the stimulus for in milliseconds. */\n    trial_duration: {\n      type: ParameterType.INT,\n      pretty_name: \"Trial duration\",\n      default: 2000,\n    },\n  },\n};\n\ntype Info = typeof info;\n\n/**\n * **vsl-grid-scene**\n *\n * jsPsych plugin for showing scenes that mimic the experiments described in\n * Fiser, J., & Aslin, R. N. (2001). Unsupervised statistical learning of\n * higher-order spatial structures from visual scenes. Psychological science,\n * 12(6), 499-504.\n *\n * @author Josh de Leeuw\n * @see {@link https://www.jspsych.org/plugins/jspsych-vsl-grid-scene/ vsl-grid-scene plugin documentation on jspsych.org}\n */\nclass VslGridScenePlugin implements JsPsychPlugin<Info> {\n  static info = info;\n\n  constructor(private jsPsych: JsPsych) {}\n\n  trial(display_element: HTMLElement, trial: TrialType<Info>) {\n    display_element.innerHTML = VslGridScenePlugin.generate_stimulus(\n      trial.stimuli,\n      trial.image_size\n    );\n\n    this.jsPsych.pluginAPI.setTimeout(function () {\n      endTrial();\n    }, trial.trial_duration);\n\n    const endTrial = () => {\n      display_element.innerHTML = \"\";\n\n      var trial_data = {\n        stimulus: trial.stimuli,\n      };\n\n      this.jsPsych.finishTrial(trial_data);\n    };\n  }\n\n  static generate_stimulus(pattern, image_size: number[]) {\n    var nrows = pattern.length;\n    var ncols = pattern[0].length;\n\n    // create blank element to hold code that we generate\n    var html = '<div id=\"jspsych-vsl-grid-scene-dummy\" css=\"display: none;\">';\n\n    // create table\n    html +=\n      '<table id=\"jspsych-vsl-grid-scene table\" ' +\n      'style=\"border-collapse: collapse; margin-left: auto; margin-right: auto;\">';\n\n    for (var row = 0; row < nrows; row++) {\n      html +=\n        '<tr id=\"jspsych-vsl-grid-scene-table-row-' +\n        row +\n        '\" css=\"height: ' +\n        image_size[1] +\n        'px;\">';\n\n      for (var col = 0; col < ncols; col++) {\n        html +=\n          '<td id=\"jspsych-vsl-grid-scene-table-' +\n          row +\n          \"-\" +\n          col +\n          '\" ' +\n          'style=\"padding: ' +\n          image_size[1] / 10 +\n          \"px \" +\n          image_size[0] / 10 +\n          'px; border: 1px solid #555;\">' +\n          '<div id=\"jspsych-vsl-grid-scene-table-cell-' +\n          row +\n          \"-\" +\n          col +\n          '\" style=\"width: ' +\n          image_size[0] +\n          \"px; height: \" +\n          image_size[1] +\n          'px;\">';\n        if (pattern[row][col] !== 0) {\n          html +=\n            \"<img \" +\n            'src=\"' +\n            pattern[row][col] +\n            '\" style=\"width: ' +\n            image_size[0] +\n            \"px; height: \" +\n            image_size[1] +\n            '\"></img>';\n        }\n        html += \"</div>\";\n        html += \"</td>\";\n      }\n      html += \"</tr>\";\n    }\n\n    html += \"</table>\";\n    html += \"</div>\";\n\n    return html;\n  }\n}\n\nexport default VslGridScenePlugin;\n"],"names":["ParameterType"],"mappings":"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"}