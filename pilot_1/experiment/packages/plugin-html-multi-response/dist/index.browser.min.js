var jsPsychHtmlMultiResponse=function(t){"use strict";function e(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var r=s.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}function s(t,s){for(var r=0;r<s.length;r++){var n=s[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,e(n.key),n)}}var r={name:"html-multi-response",parameters:{stimulus:{type:t.ParameterType.HTML_STRING,pretty_name:"Stimulus",default:void 0},button_choices:{type:t.ParameterType.STRING,pretty_name:"Button Choices",default:[],array:!0},keyboard_choices:{type:t.ParameterType.KEYS,pretty_name:"Keyboard Choices",default:"NO_KEYS"},button_html:{type:t.ParameterType.HTML_STRING,pretty_name:"Button HTML",default:'<button class="jspsych-btn">%choice%</button>',array:!0},prompt:{type:t.ParameterType.HTML_STRING,pretty_name:"Prompt",default:null},stimulus_duration:{type:t.ParameterType.INT,pretty_name:"Stimulus duration",default:null},trial_duration:{type:t.ParameterType.INT,pretty_name:"Trial duration",default:null},margin_vertical:{type:t.ParameterType.STRING,pretty_name:"Margin vertical",default:"0px"},margin_horizontal:{type:t.ParameterType.STRING,pretty_name:"Margin horizontal",default:"8px"},response_ends_trial:{type:t.ParameterType.BOOL,pretty_name:"Response ends trial",default:!0}}},n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.jsPsych=e}var e,r,n;return e=t,r=[{key:"trial",value:function(t,e){var s=this,r='<div id="jspsych-html-multi-response-stimulus">'+e.stimulus+"</div>",n=[];if(Array.isArray(e.button_html))e.button_html.length==e.button_choices.length?n=e.button_html:console.error("Error in html-multi-response plugin. The length of the button_html array does not equal the length of the button_choices array");else for(var i=0;i<e.button_choices.length;i++)n.push(e.button_html);for(r+='<div id="jspsych-html-multi-response-btngroup">',i=0;i<e.button_choices.length;i++){var a=n[i].replace(/%choice%/g,e.button_choices[i]);r+='<div class="jspsych-html-multi-response-button" style="display: inline-block; margin:'+e.margin_vertical+" "+e.margin_horizontal+'" id="jspsych-html-multi-response-button-'+i+'" data-choice="'+i+'">'+a+"</div>"}if(r+="</div>",null!==e.prompt&&(r+=e.prompt),t.innerHTML=r,"NO_KEYS"!=e.keyboard_choices)var o=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:function(s){t.querySelector("#jspsych-html-multi-response-stimulus").className+=" responded",null==l.key&&(l=Object.assign({source:"keyboard",button:null},s)),e.response_ends_trial&&c()},valid_responses:e.keyboard_choices,rt_method:"performance",persist:!1,allow_held_key:!1});var u=performance.now();for(i=0;i<e.button_choices.length;i++)t.querySelector("#jspsych-html-multi-response-button-"+i).addEventListener("click",(function(t){p(t.currentTarget.getAttribute("data-choice"))}));var l={rt:null,button:null,key:null,source:null},c=function(){s.jsPsych.pluginAPI.clearAllTimeouts(),void 0!==o&&s.jsPsych.pluginAPI.cancelKeyboardResponse(o);var r={rt:l.rt,stimulus:e.stimulus,button_response:l.button,keyboard_response:l.key,response_source:l.source};t.innerHTML="",s.jsPsych.finishTrial(r)};function p(s){var r=performance.now(),n=Math.round(r-u);l.button=parseInt(s),l.rt=n,l.source="button",t.querySelector("#jspsych-html-multi-response-stimulus").className+=" responded";for(var i=document.querySelectorAll(".jspsych-html-multi-response-button button"),a=0;a<i.length;a++)i[a].setAttribute("disabled","disabled");e.response_ends_trial&&c()}null!==e.stimulus_duration&&this.jsPsych.pluginAPI.setTimeout((function(){t.querySelector("#jspsych-html-multi-response-stimulus").style.visibility="hidden"}),e.stimulus_duration),null!==e.trial_duration&&this.jsPsych.pluginAPI.setTimeout(c,e.trial_duration)}},{key:"simulate",value:function(t,e,s,r){"data-only"==e&&(r(),this.simulate_data_only(t,s)),"visual"==e&&this.simulate_visual(t,s,r)}},{key:"create_simulation_data",value:function(t,e){var s={stimulus:t.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),keyboard_response:this.jsPsych.pluginAPI.getValidKey(t.keyboard_choices),button_response:null,response_source:"keyboard"},r={stimulus:t.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),button_response:this.jsPsych.randomization.randomInt(0,t.button_choices.length-1),keyboard_response:null,response_source:"button"},n=Math.random()<.5?s:r,i=this.jsPsych.pluginAPI.mergeSimulationData(n,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,i),i}},{key:"simulate_data_only",value:function(t,e){var s=this.create_simulation_data(t,e);this.jsPsych.finishTrial(s)}},{key:"simulate_visual",value:function(t,e,s){var r=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement();this.trial(n,t),s(),null!==r.rt&&(null!==r.button_response?this.jsPsych.pluginAPI.clickTarget(n.querySelector('div[data-choice="'.concat(r.button_response,'"] button')),r.rt):this.jsPsych.pluginAPI.pressKey(r.keyboard_response,r.rt))}}],r&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();return n.info=r,n}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
