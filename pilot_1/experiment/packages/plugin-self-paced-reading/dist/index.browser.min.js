var jsPsychSelfPacedReading=function(e){"use strict";function t(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t(n.key),n)}}var r={name:"self-paced-reading",parameters:{sentence:{type:e.ParameterType.STRING,pretty_name:"Sentence",default:void 0},font_family:{type:e.ParameterType.STRING,pretty_name:"Font family",default:"monospace"},font_size:{type:e.ParameterType.STRING,pretty_name:"Font size",default:"24px"},font_weight:{type:e.ParameterType.STRING,pretty_name:"Font weight",default:"normal"},font_colour:{type:e.ParameterType.STRING,pretty_name:"Font colour",default:"black"},mask_type:{type:e.ParameterType.INT,pretty_name:"Mask type",default:1},mask_character:{type:e.ParameterType.STRING,pretty_name:"Mask character",default:"_"},mask_on_word:{type:e.ParameterType.BOOL,pretty_name:"Mask word",default:!0},mask_gap_character:{type:e.ParameterType.STRING,pretty_name:"Mask gap character.",default:" "},mask_offset:{type:e.ParameterType.INT,pretty_name:"Mask offset",default:0},mask_weight:{type:e.ParameterType.STRING,pretty_name:"Mask weight",default:"normal"},mask_colour:{type:e.ParameterType.STRING,pretty_name:"Mask colour",default:"black"},line_height:{type:e.ParameterType.INT,pretty_name:"Line height",default:80},canvas_colour:{type:e.ParameterType.STRING,pretty_name:"Canvas colour",default:"white"},canvas_size:{type:e.ParameterType.INT,array:!0,pretty_name:"Canvas size",default:[1280,960]},canvas_border:{type:e.ParameterType.STRING,pretty_name:"Canvas border",default:"0px solid black"},canvas_clear_border:{type:e.ParameterType.BOOL,pretty_name:"Clear canvas border",default:!1},translate_origin:{type:e.ParameterType.BOOL,pretty_name:"Translate origin",default:!0},choices:{type:e.ParameterType.KEYS,pretty_name:"Keys",default:[" "]},xy_position:{type:e.ParameterType.INT,array:!0,pretty_name:"XY position",default:[0,0]},x_align:{type:e.ParameterType.STRING,pretty_name:"X alignment",default:"center"},y_align:{type:e.ParameterType.STRING,pretty_name:"Y alignment",default:"top"},inter_word_interval:{type:e.ParameterType.INT,pretty_name:"inter-word-interval",default:0}}};function n(e,t){return t.repeat(e.length)}var i={1:function(e,t){return e!==t},2:function(e,t){return e>t}};var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jsPsych=t}var t,r,o;return t=e,r=[{key:"trial",value:function(e,t){var a=this;e.innerHTML='<div><canvas id="canvas" width="'+t.canvas_size[0]+'" height="'+t.canvas_size[1]+'" style="border: '+t.canvas_border+';"></canvas></div>';var r=document.getElementById("canvas"),o=r.getContext("2d"),l=function(e,t,a,r){var n;return r?(t.translate(e.width/2,e.height/2),n=[-e.width/2,-e.height/2,e.width,e.height]):n=[0,0,e.width,e.height],t.fillStyle=a,t.fillRect(n[0],n[1],n[2],n[3]),n}(r,o,t.canvas_colour,t.translate_origin);o.textAlign=t.x_align,o.textBaseline="middle";var s,p=[],y=[],c=0,_=-1,f=-1,m=0,u=t.sentence.replace(/(\r\n|\n|\r)/gm,""),h=u.split(" "),d=t.font_weight+" "+t.font_size+" "+t.font_family,g=t.mask_weight+" "+t.font_size+" "+t.font_family,v=[0],T=3!==t.mask_type?t.mask_character:t.mask_character.repeat(h[0].length);if(3!==t.mask_type){s=t.sentence.split("\n").map((function(e){return e.trim()}));for(var P=0;P<s.length;P++)p[P]=s[P].split(" "),c+=p[P].length,y.push(p[P].length);p.length>1&&"center"===t.y_align&&(t.xy_position[1]-=.5*p.length*t.line_height)}else p=t.sentence.split(" "),c=p.length;var k,w=(k=t.mask_type,function(e,t){return e.map((function(e,a){return i[k](a,t)?n(e," "):e})).join(" ")}),b=function(e,t,a,r){return function(o,l){return o.map((function(r,o){return i[e](o,l)?n(r,a):n(r,t?a:" ")})).join(r)}}(t.mask_type,t.mask_on_word,T,t.mask_gap_character);function x(){if(o.font=g,o.fillStyle=t.mask_colour,3!==t.mask_type)for(var e=0;e<p.length;e++){var a=e===m?f:-1;o.fillText(b(p[e],a),t.xy_position[0],t.xy_position[1]+e*t.line_height+t.mask_offset)}else 3===t.mask_type&&-1===_&&o.fillText(T,t.xy_position[0],t.xy_position[1]+t.mask_offset)}function I(){if(o.font=d,o.fillStyle=t.font_colour,3!==t.mask_type){for(var e=0;e<m;e++)o.fillText(w(p[e],p[e].length),t.xy_position[0],t.xy_position[1]+e*t.line_height);o.fillText(w(p[m],f),t.xy_position[0],t.xy_position[1]+m*t.line_height)}else 3===t.mask_type&&_>-1&&o.fillText(p[_],t.xy_position[0],t.xy_position[1]);f+1<y[m]?f++:m<p.length-1&&(m++,f=0)}var S={word:[],rt:[],rt_total:[],sentence:u};x(),I();var N=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:function(r){v.push(r.rt);var n=-1===_?0:t.inter_word_interval,i=v[v.length-1]-v[v.length-2]-n,s=-1===_?null:h[_];i>0?(S.rt.push(i),S.rt_total.push(v[v.length-1]),S.word.push(s),_++,a.jsPsych.pluginAPI.setTimeout((function(){_<c?(o.fillStyle=t.canvas_colour,o.font=t.canvas_colour,o.fillRect(l[0],l[1],l[2],l[3]),x(),I()):(t.canvas_clear_border?e.innerHTML=" ":(o.fillStyle=t.canvas_colour,o.fillRect(l[0],l[1],l[2],l[3])),a.jsPsych.pluginAPI.clearAllTimeouts(),a.jsPsych.pluginAPI.cancelKeyboardResponse(N),a.jsPsych.finishTrial(S))}),t.inter_word_interval)):v.pop()},valid_responses:t.choices,rt_method:"performance",persist:!0,allow_held_key:!1})}}],r&&a(t.prototype,r),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();return o.info=r,o}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
