var jsPsychCorsiBlocks=function(e){"use strict";function t(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function o(e,o){for(var r=0;r<o.length;r++){var n=o[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t(n.key),n)}}var r={name:"corsi-blocks",parameters:{sequence:{type:e.ParameterType.INT,default:void 0,array:!0},blocks:{type:e.ParameterType.COMPLEX,array:!0,default:[{y:80,x:45},{y:94,x:80},{y:70,x:20},{y:60,x:70},{y:50,x:35},{y:40,x:6},{y:45,x:94},{y:25,x:60},{y:6,x:47}],nested:{x:{type:e.ParameterType.INT,default:void 0},y:{type:e.ParameterType.INT,default:void 0}}},block_size:{type:e.ParameterType.INT,default:12},display_width:{type:e.ParameterType.STRING,default:"400px"},display_height:{type:e.ParameterType.STRING,default:"400px"},prompt:{type:e.ParameterType.STRING,default:null},mode:{type:e.ParameterType.STRING,default:"display",options:["display","input"]},sequence_gap_duration:{type:e.ParameterType.INT,default:250},sequence_block_duration:{type:e.ParameterType.INT,default:1e3},pre_stim_duration:{type:e.ParameterType.INT,default:500},response_animation_duration:{type:e.ParameterType.INT,default:500},block_color:{type:e.ParameterType.STRING,default:"#555"},highlight_color:{type:e.ParameterType.STRING,default:"#ff0000"},correct_color:{type:e.ParameterType.STRING,default:"#00ff00"},incorrect_color:{type:e.ParameterType.STRING,default:"#ff0000"}}},n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jsPsych=t}var t,r,n;return t=e,(r=[{key:"trial",value:function(e,t){var o=this,r='<style id="jspsych-corsi-css">\n      #jspsych-corsi-stimulus { \n        position: relative; \n        width:'.concat(t.display_width,"; \n        height:").concat(t.display_height,";\n      }\n      .jspsych-corsi-block { \n        background-color: ").concat(t.block_color,"; \n        position: absolute; \n        width: ").concat(t.block_size,"%; \n        height: ").concat(t.block_size,"%;\n        transform: translate(-50%, -50%);\n      }\n      #jspsych-corsi-prompt { \n        position: absolute; \n        text-align: center; \n        width: ").concat(t.display_width,"; \n        top: 100%; \n      }\n      #jspsych-corsi-prompt p { \n        font-size: 18px; \n      }\n      ").concat("input"==t.mode?".jspsych-corsi-block { cursor: pointer; }":"","\n    </style>");r+='<div id="jspsych-corsi-stimulus">';for(var n=0;n<t.blocks.length;n++)r+='<div class="jspsych-corsi-block" data-id="'.concat(n,'" style="top:').concat(t.blocks[n].y,"%; left:").concat(t.blocks[n].x,'%;"></div>');null!=t.prompt&&(r+='<div id="jspsych-corsi-prompt"><p>'.concat(t.prompt,"</p></div>")),r+="</div>",e.innerHTML=r;var c=performance.now(),a={sequence:t.sequence,response:[],rt:[],blocks:t.blocks,correct:null},i=function(){e.innerHTML="",o.jsPsych.finishTrial(a)},s=function(e,t){var o=performance.now(),r=function e(t,r,n){performance.now()-n>=r?t():window.requestAnimationFrame((function(){return e(t,r,o)}))};window.requestAnimationFrame((function(){return r(e,t,o)}))};if("display"==t.mode){var l=0,p="pre-stim";window.requestAnimationFrame((function o(){if("pre-stim"==p)s(o,t.pre_stim_duration),p="sequence";else if("sequence"==p){var r=e.querySelector('.jspsych-corsi-block[data-id="'.concat(t.sequence[l],'"]'));l<t.sequence.length&&(r.style.backgroundColor=t.highlight_color,s(o,t.sequence_block_duration),p="iti"),l==t.sequence.length&&i()}else"iti"==p&&(e.querySelector('.jspsych-corsi-block[data-id="'.concat(t.sequence[l],'"]')).style.backgroundColor=t.block_color,l++,s(o,t.sequence_gap_duration),p="sequence")}))}if("input"==t.mode)for(var u=[{backgroundColor:t.block_color},{backgroundColor:t.correct_color,offset:.2},{backgroundColor:t.block_color}],y=[{backgroundColor:t.block_color},{backgroundColor:t.incorrect_color,offset:.2},{backgroundColor:t.block_color}],d={duration:t.response_animation_duration,iterations:1},f=function(o){if(null===a.correct){var r=Math.round(performance.now()-c);a.response.push(parseInt(o)),a.rt.push(r),parseInt(o)==t.sequence[a.response.length-1]?(e.querySelector('.jspsych-corsi-block[data-id="'.concat(o,'"]')).animate(u,d),a.response.length==t.sequence.length&&(a.correct=!0,setTimeout(i,t.response_animation_duration))):(e.querySelector('.jspsych-corsi-block[data-id="'.concat(o,'"]')).animate(y,d),a.correct=!1,setTimeout(i,t.response_animation_duration))}},m=e.querySelectorAll(".jspsych-corsi-block"),h=0;h<m.length;h++)m[h].addEventListener("click",(function(e){f(e.target.getAttribute("data-id"))}))}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();return n.info=r,n}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
