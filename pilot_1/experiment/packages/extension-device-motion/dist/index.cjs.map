{"version":3,"file":"index.cjs","sources":["../src/index.ts"],"sourcesContent":["import { JsPsych, JsPsychExtension, JsPsychExtensionInfo } from \"jspsych\";\n\nclass DeviceMotionExtension implements JsPsychExtension {\n  static info: JsPsychExtensionInfo = {\n    name: \"device-motion-tracking\",\n  };\n\n  constructor(private jsPsych: JsPsych) {}\n\n  private currentTrialData: Array<object>;\n  private currentTrialStartTime: number;\n\n  initialize = async () => {};\n\n  on_start = (): void => {\n    this.currentTrialData = [];\n  };\n\n  on_load = () => {\n    // set current trial start time\n    this.currentTrialStartTime = performance.now();\n\n    // start data collection\n    window.addEventListener(\"devicemotion\", this.deviceMotionEventHandler, true);\n  };\n\n  on_finish = () => {\n    window.removeEventListener(\"devicemotion\", this.deviceMotionEventHandler, true);\n\n    return {\n      device_motion_data: this.currentTrialData,\n    };\n  };\n\n  private deviceMotionEventHandler = (eventA) => {\n    const event_time = performance.now();\n    const t = Math.round(event_time - this.currentTrialStartTime);\n\n    const { x, y, z } = eventA.acceleration;\n    const interval = eventA.interval; //gets interval between samples in ms\n    this.currentTrialData.push({ x, y, z, interval, t });\n  };\n}\n\nexport default DeviceMotionExtension;\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,MAAM,qBAAqB,CAAA;AAKzB,IAAA,WAAA,CAAoB,OAAgB,EAAA;QAAhB,IAAO,CAAA,OAAA,GAAP,OAAO,CAAS;AAKpC,QAAA,IAAA,CAAA,UAAU,GAAG,MAAa,SAAA,CAAA,IAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,aAAA,GAAC,CAAA,CAAC;QAE5B,IAAQ,CAAA,QAAA,GAAG,MAAW;AACpB,YAAA,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;AAC7B,SAAC,CAAC;QAEF,IAAO,CAAA,OAAA,GAAG,MAAK;;AAEb,YAAA,IAAI,CAAC,qBAAqB,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;;YAG/C,MAAM,CAAC,gBAAgB,CAAC,cAAc,EAAE,IAAI,CAAC,wBAAwB,EAAE,IAAI,CAAC,CAAC;AAC/E,SAAC,CAAC;QAEF,IAAS,CAAA,SAAA,GAAG,MAAK;YACf,MAAM,CAAC,mBAAmB,CAAC,cAAc,EAAE,IAAI,CAAC,wBAAwB,EAAE,IAAI,CAAC,CAAC;YAEhF,OAAO;gBACL,kBAAkB,EAAE,IAAI,CAAC,gBAAgB;aAC1C,CAAC;AACJ,SAAC,CAAC;AAEM,QAAA,IAAA,CAAA,wBAAwB,GAAG,CAAC,MAAM,KAAI;AAC5C,YAAA,MAAM,UAAU,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;AACrC,YAAA,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC,qBAAqB,CAAC,CAAC;YAE9D,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,MAAM,CAAC,YAAY,CAAC;AACxC,YAAA,MAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;AACjC,YAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC;AACvD,SAAC,CAAC;KAlCsC;;AAJjC,qBAAA,CAAA,IAAI,GAAyB;AAClC,IAAA,IAAI,EAAE,wBAAwB;AAC/B,CAFU;;;;"}