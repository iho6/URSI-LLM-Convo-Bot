{"version":3,"file":"index.browser.js","sources":["../src/index.ts"],"sourcesContent":["import { JsPsych, JsPsychExtension, JsPsychExtensionInfo } from \"jspsych\";\n\nclass DeviceMotionExtension implements JsPsychExtension {\n  static info: JsPsychExtensionInfo = {\n    name: \"device-motion-tracking\",\n  };\n\n  constructor(private jsPsych: JsPsych) {}\n\n  private currentTrialData: Array<object>;\n  private currentTrialStartTime: number;\n\n  initialize = async () => {};\n\n  on_start = (): void => {\n    this.currentTrialData = [];\n  };\n\n  on_load = () => {\n    // set current trial start time\n    this.currentTrialStartTime = performance.now();\n\n    // start data collection\n    window.addEventListener(\"devicemotion\", this.deviceMotionEventHandler, true);\n  };\n\n  on_finish = () => {\n    window.removeEventListener(\"devicemotion\", this.deviceMotionEventHandler, true);\n\n    return {\n      device_motion_data: this.currentTrialData,\n    };\n  };\n\n  private deviceMotionEventHandler = (eventA) => {\n    const event_time = performance.now();\n    const t = Math.round(event_time - this.currentTrialStartTime);\n\n    const { x, y, z } = eventA.acceleration;\n    const interval = eventA.interval; //gets interval between samples in ms\n    this.currentTrialData.push({ x, y, z, interval, t });\n  };\n}\n\nexport default DeviceMotionExtension;\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEA,MAAM,qBAAqB,CAAA;IAKzB,IAAA,WAAA,CAAoB,OAAgB,EAAA;YAAhB,IAAO,CAAA,OAAA,GAAP,OAAO,CAAS;IAKpC,QAAA,IAAA,CAAA,UAAU,GAAG,MAAa,SAAA,CAAA,IAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,aAAA,GAAC,CAAA,CAAC;YAE5B,IAAQ,CAAA,QAAA,GAAG,MAAW;IACpB,YAAA,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;IAC7B,SAAC,CAAC;YAEF,IAAO,CAAA,OAAA,GAAG,MAAK;;IAEb,YAAA,IAAI,CAAC,qBAAqB,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;;gBAG/C,MAAM,CAAC,gBAAgB,CAAC,cAAc,EAAE,IAAI,CAAC,wBAAwB,EAAE,IAAI,CAAC,CAAC;IAC/E,SAAC,CAAC;YAEF,IAAS,CAAA,SAAA,GAAG,MAAK;gBACf,MAAM,CAAC,mBAAmB,CAAC,cAAc,EAAE,IAAI,CAAC,wBAAwB,EAAE,IAAI,CAAC,CAAC;gBAEhF,OAAO;oBACL,kBAAkB,EAAE,IAAI,CAAC,gBAAgB;iBAC1C,CAAC;IACJ,SAAC,CAAC;IAEM,QAAA,IAAA,CAAA,wBAAwB,GAAG,CAAC,MAAM,KAAI;IAC5C,YAAA,MAAM,UAAU,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;IACrC,YAAA,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC,qBAAqB,CAAC,CAAC;gBAE9D,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,MAAM,CAAC,YAAY,CAAC;IACxC,YAAA,MAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;IACjC,YAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC;IACvD,SAAC,CAAC;SAlCsC;;IAJjC,qBAAA,CAAA,IAAI,GAAyB;IAClC,IAAA,IAAI,EAAE,wBAAwB;IAC/B,CAFU;;;;;;;;"}