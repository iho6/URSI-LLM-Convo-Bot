"0","#| label: Create a data frame that is just for surveys and clean it up a bit"
"0","#| include: false"
"0",""
"0","surveys_cleaning_df <- raw_df %>%"
"0","  # Remove the first four subjects of the pilot who participant in the experiment before Jackie made the code easier to perform data analysis on "
"0","  filter(prolific_subject_id != ""5ff3b5986d65c5a24eebd036"") %>%"
"0","  filter(prolific_subject_id != ""663ceae2f9337d71cfe99679"") %>%"
"0","  filter(prolific_subject_id != ""6550dd527fede9c068b3a08b"") %>% "
"0","  filter(prolific_subject_id != ""665b86a9372cfba059fbc8e9"") %>%"
"0","  # Remove a column that we don't care about for surveys"
"0","  select(- internal_node_id) %>%"
"0","  # Filter for only surveys"
"0","  filter(trial_type == ""survey"") %>%"
"0","  # Remove control interventions (these are technically surveys)"
"0","  filter(phase != ""control-intervention"") %>%"
"0","  # Remove the matrix question titles because they mess with separating questions from answers "
"0","  mutate(across(everything(), ~ gsub('""rating-republicans"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""rating-democrats"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""interacting-with-republicans"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""interacting-with-democrats"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-polarization"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-polarization"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-polarization"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-polarization"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-polarization"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-polarization"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-polarization"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-polarization-general"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-polarization-general"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-polarization-general"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-polarization-general"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-polarization-general"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-polarization-general"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-polarization-general"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-offending-reason"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-offending-reason"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-offending-reason"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-offending-reason"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-offending-reason"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-offending-reason"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-offending-reason"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-euthanasia-openmindedness"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-gender-openmindedness"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-healthcare-openmindedness"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-bombing-openmindedness"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-vaccines-openmindedness"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-criminal-openmindedness"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-same-sex-openmindedness"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-openmindedness-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-openmindedness-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-openmindedness-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-openmindedness-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-openmindedness-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-openmindedness-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-openmindedness-post"":null,', '', .))) %>% "
"0","  mutate(across(everything(), ~ gsub('""euthanasia-reason-of-avoidance"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-reason-of-avoidance"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-reason-of-avoidance"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-reason-of-avoidance"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-reason-of-avoidance"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-reason-of-avoidance"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-reason-of-avoidance"":null,', '', .))) %>%"
"0"," mutate(across(everything(), ~ gsub('""euthanasia-polarization-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-polarization-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-polarization-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-polarization-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-polarization-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-polarization-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-polarization-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-polarization-general-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-polarization-general-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-polarization-general-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-polarization-general-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-polarization-general-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-polarization-general-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-polarization-general-post-"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""rating-republicans-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""rating-democrats-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""interacting-with-republicans-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""interacting-with-democrats-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-reason-of-avoidance-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-reason-of-avoidance-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-reason-of-avoidance-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-reason-of-avoidance-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-reason-of-avoidance-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-reason-of-avoidance-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-reason-of-avoidance-post"":null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub(',null,', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""rating-republicans"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""rating-democrats"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""interacting-with-republicans"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""interacting-with-democrats"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-polarization"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-polarization"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-polarization"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-polarization"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-polarization"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-polarization"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-polarization"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-polarization-general"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-polarization-general"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-polarization-general"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-polarization-general"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-polarization-general"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-polarization-general"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-polarization-general"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-offending-reason"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-offending-reason"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-offending-reason"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-offending-reason"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-offending-reason"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-offending-reason"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-offending-reason"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-euthanasia-openmindedness"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-gender-openmindedness"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-healthcare-openmindedness"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-bombing-openmindedness"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-vaccines-openmindedness"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-criminal-openmindedness"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""pre-same-sex-openmindedness"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-openmindedness-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-openmindedness-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-openmindedness-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-openmindedness-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-openmindedness-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-openmindedness-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-openmindedness-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-reason-of-avoidance"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-reason-of-avoidance"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-reason-of-avoidance"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-reason-of-avoidance"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-reason-of-avoidance"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-reason-of-avoidance"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-reason-of-avoidance"":', '', .))) %>% "
"0","  mutate(across(everything(), ~ gsub('""euthanasia-polarization-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-polarization-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-polarization-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-polarization-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-polarization-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-polarization-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-polarization-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-polarization-general-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-polarization-general-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-polarization-general-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-polarization-general-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-polarization-general-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-polarization-general-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-polarization-general-post-"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""rating-republicans-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""rating-democrats-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""interacting-with-republicans-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""interacting-with-democrats-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""euthanasia-reason-of-avoidance-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""gender-reason-of-avoidance-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""healthcare-reason-of-avoidance-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""bombing-reason-of-avoidance-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""vaccines-reason-of-avoidance-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""criminal-reason-of-avoidance-post"":', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('""same-sex-reason-of-avoidance-post"":', '', .)))"
"0",""
"0","  #Add a comma before the euthanasia-slider1 question because there isn't one for some reason and it messes up the rest of the code"
"0","  surveys_cleaning_df$response <- gsub(""\\}\""euthanasia"", ""\\},\""euthanasia"", surveys_cleaning_df$response)"
"0","  "
"0","surveys_df <- surveys_cleaning_df %>%"
"0","  # Remove weird characters but don't remove quotations because we need them for separating questions"
"0","  mutate(across(everything(), ~ gsub('}', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('\\{', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('\\[', '', .))) %>%"
"0","  mutate(across(everything(), ~ gsub('\\]', '', .))) %>%"
"0","  # Make each question its own row"
"0","  separate_rows(response, sep = ',""') %>%"
"0","  # Remove any leftover quotation marks"
"0","  mutate(across(everything(), ~ gsub('""', '', .))) %>%"
"0","  # Move answers to a new column"
"0","  separate(response, into = c(""question"", ""answer""), sep = "":"", extra = ""merge"", fill = ""right"") %>%"
"0","  # Remove all remaining questions that were answered with null (like the slider questions, because the slider 'placeholder' questions are where people actually answer the slider questions)"
"0","  filter(!is.na(answer) & answer != 'null' & answer != 'null,null') %>%"
"0","  # Remove the gender polarization line that we currently don't know how to code "
"0","  filter(!grepl(""Gender should be disregarded when selecting candidates for career advancement opportunities"", question)) %>%"
"0","  # REMOVE THIS LINE WHEN ANALYZING THE FULL EXPERIMENT DATA; WE CHANGED THE EXPERIMENT HTML SO THIS LINE WON'T BE NECESSARY IN THE FUTURE. Recode a likert rating item that we forgot to change in the experiment html"
"0","  mutate(answer = ifelse(question == ""willing-to-converse-likert-post"","
"0","                         recode(answer, "
"0","                                ""Item 1"" = ""1"", "
"0","                                ""Item 2"" = ""2"", "
"0","                                ""Item 3"" = ""3"", "
"0","                                ""Item 4"" = ""4"", "
"0","                                ""Item 5"" = ""5""),"
"0","                         answer))"
